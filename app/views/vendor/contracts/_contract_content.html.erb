<%# app/views/vendor/contracts/_contract_content.html.erb %>
<%# This partial is used by ContractGeneratorService to render contract content %>

<div class="contract-content" style="font-family: 'Inter', 'Calibri', sans-serif; color: #1f2937;">
  <!-- Header with corporate blue -->
  <div class="contract-header" style="background-color: #125282; color: white; padding: 2rem; border-radius: 0.5rem 0.5rem 0 0; margin-bottom: 2rem;">
    <h1 style="font-size: 28pt; font-weight: bold; margin: 0; text-align: center;">
      CONTRATO DE CRÉDITO MOVICUOTAS
    </h1>
    <p style="text-align: center; margin-top: 0.5rem; opacity: 0.9;">
      "Tu Crédito, Tu Móvil"
    </p>
  </div>

  <!-- Contract Number -->
  <div class="contract-number" style="text-align: right; margin-bottom: 2rem; border-bottom: 2px solid #125282; padding-bottom: 1rem;">
    <p style="font-size: 14pt; font-weight: bold; color: #125282;">
      Número de Contrato: <span style="color: #1f2937;"><%= loan.contract_number %></span>
    </p>
    <p style="font-size: 12pt; color: #6b7280;">
      Fecha: <%= I18n.l(Date.today, format: :long) %>
    </p>
  </div>

  <!-- Parties Section -->
  <div class="parties-section" style="margin-bottom: 2rem;">
    <h2 style="font-size: 20pt; font-weight: semibold; color: #125282; border-bottom: 1px solid #d1d5db; padding-bottom: 0.5rem;">
      PARTES CONTRATANTES
    </h2>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 1rem;">
      <div>
        <h3 style="font-size: 16pt; font-weight: bold; color: #1f2937; margin-bottom: 1rem;">
          CLIENTE
        </h3>
        <table style="width: 100%; font-size: 12pt;">
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.25rem 0;">Nombre Completo:</td>
            <td style="padding: 0.25rem 0;"><%= customer.full_name %></td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.25rem 0;">No. Identidad:</td>
            <td style="padding: 0.25rem 0;"><%= customer.identification_number %></td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.25rem 0;">Edad:</td>
            <td style="padding: 0.25rem 0;"><%= service.customer_age %> años</td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.25rem 0;">Teléfono:</td>
            <td style="padding: 0.25rem 0;"><%= customer.phone %></td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.25rem 0;">Dirección:</td>
            <td style="padding: 0.25rem 0;"><%= customer.address %>, <%= customer.city %>, <%= customer.department %></td>
          </tr>
        </table>
      </div>

      <div>
        <h3 style="font-size: 16pt; font-weight: bold; color: #1f2937; margin-bottom: 1rem;">
          MOVICUOTAS
        </h3>
        <table style="width: 100%; font-size: 12pt;">
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.25rem 0;">Empresa:</td>
            <td style="padding: 0.25rem 0;">MOVICUOTAS - Tu Crédito, Tu Móvil</td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.25rem 0;">Sucursal:</td>
            <td style="padding: 0.25rem 0;"><%= loan.branch_number %></td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.25rem 0;">Representante:</td>
            <td style="padding: 0.25rem 0;"><%= loan.user&.full_name || 'Vendedor Autorizado' %></td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.25rem 0;">Teléfono:</td>
            <td style="padding: 0.25rem 0;">+504 2234-5678</td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.25rem 0;">Dirección:</td>
            <td style="padding: 0.25rem 0;">Tegucigalpa, Honduras</td>
          </tr>
        </table>
      </div>
    </div>
  </div>

  <!-- Device Information -->
  <div class="device-section" style="margin-bottom: 2rem;">
    <h2 style="font-size: 20pt; font-weight: semibold; color: #125282; border-bottom: 1px solid #d1d5db; padding-bottom: 0.5rem;">
      DISPOSITIVO FINANCIADO
    </h2>

    <table style="width: 100%; font-size: 12pt; margin-top: 1rem;">
      <tr>
        <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0; width: 30%;">Marca:</td>
        <td style="padding: 0.5rem 0;"><%= device.brand %></td>
      </tr>
      <tr>
        <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0;">Modelo:</td>
        <td style="padding: 0.5rem 0;"><%= device.model %></td>
      </tr>
      <tr>
        <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0;">Color:</td>
        <td style="padding: 0.5rem 0;"><%= device.color %></td>
      </tr>
      <tr>
        <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0;">IMEI:</td>
        <td style="padding: 0.5rem 0; font-family: monospace;"><%= device.imei %></td>
      </tr>
    </table>
  </div>

  <!-- Financial Terms -->
  <div class="financial-section" style="margin-bottom: 2rem;">
    <h2 style="font-size: 20pt; font-weight: semibold; color: #125282; border-bottom: 1px solid #d1d5db; padding-bottom: 0.5rem;">
      TÉRMINOS FINANCIEROS
    </h2>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 1rem;">
      <div>
        <h3 style="font-size: 16pt; font-weight: bold; color: #1f2937; margin-bottom: 1rem;">
          MONTO DEL CRÉDITO
        </h3>
        <table style="width: 100%; font-size: 12pt;">
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0;">Precio Total:</td>
            <td style="padding: 0.5rem 0; text-align: right; font-weight: bold;"><%= service.format_currency(loan.total_amount) %></td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0;">Porcentaje de Enganche:</td>
            <td style="padding: 0.5rem 0; text-align: right;"><%= loan.down_payment_percentage %>%</td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0;">Monto de Enganche:</td>
            <td style="padding: 0.5rem 0; text-align: right;"><%= service.format_currency(loan.down_payment_amount) %></td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0; border-top: 1px solid #d1d5db;">Monto Financiado:</td>
            <td style="padding: 0.5rem 0; text-align: right; border-top: 1px solid #d1d5db; font-weight: bold; color: #125282;">
              <%= service.format_currency(loan.financed_amount) %>
            </td>
          </tr>
        </table>
      </div>

      <div>
        <h3 style="font-size: 16pt; font-weight: bold; color: #1f2937; margin-bottom: 1rem;">
          DETALLES DEL PAGO
        </h3>
        <table style="width: 100%; font-size: 12pt;">
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0;">Tasa de Interés Anual:</td>
            <td style="padding: 0.5rem 0; text-align: right;"><%= loan.interest_rate %>%</td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0;">Número de Cuotas:</td>
            <td style="padding: 0.5rem 0; text-align: right;"><%= loan.number_of_installments %> (quincenales)</td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0;">Fecha de Inicio:</td>
            <td style="padding: 0.5rem 0; text-align: right;"><%= I18n.l(loan.start_date, format: :long) %></td>
          </tr>
          <tr>
            <td style="font-weight: bold; color: #6b7280; padding: 0.5rem 0; border-top: 1px solid #d1d5db;">Cuota Quincenal:</td>
            <td style="padding: 0.5rem 0; text-align: right; border-top: 1px solid #d1d5db; font-weight: bold; color: #125282;">
              <%= service.format_currency(loan.installments.first&.amount || loan.financed_amount / loan.number_of_installments) %>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>

  <!-- Payment Schedule -->
  <div class="payment-schedule" style="margin-bottom: 2rem;">
    <h2 style="font-size: 20pt; font-weight: semibold; color: #125282; border-bottom: 1px solid #d1d5db; padding-bottom: 0.5rem;">
      CRONOGRAMA DE PAGOS
    </h2>

    <div style="overflow-x: auto; margin-top: 1rem;">
      <table style="width: 100%; font-size: 11pt; border-collapse: collapse;">
        <thead>
          <tr style="background-color: #f3f4f6;">
            <th style="padding: 0.75rem; text-align: left; border: 1px solid #d1d5db;">No.</th>
            <th style="padding: 0.75rem; text-align: left; border: 1px solid #d1d5db;">Fecha de Vencimiento</th>
            <th style="padding: 0.75rem; text-align: right; border: 1px solid #d1d5db;">Monto</th>
            <th style="padding: 0.75rem; text-align: center; border: 1px solid #d1d5db;">Estado</th>
          </tr>
        </thead>
        <tbody>
          <% installment_details.each do |installment| %>
            <tr>
              <td style="padding: 0.75rem; border: 1px solid #d1d5db;"><%= installment[:number] %></td>
              <td style="padding: 0.75rem; border: 1px solid #d1d5db;"><%= installment[:due_date] %></td>
              <td style="padding: 0.75rem; border: 1px solid #d1d5db; text-align: right;"><%= installment[:amount] %></td>
              <td style="padding: 0.75rem; border: 1px solid #d1d5db; text-align: center;">
                <span style="<%= service.installment_status_style(installment[:status]) %>">
                  <%= installment[:status].titleize %>
                </span>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Terms and Conditions -->
  <div class="terms-section" style="margin-bottom: 2rem;">
    <h2 style="font-size: 20pt; font-weight: semibold; color: #125282; border-bottom: 1px solid #d1d5db; padding-bottom: 0.5rem;">
      TÉRMINOS Y CONDICIONES
    </h2>

    <div style="font-size: 11pt; line-height: 1.6; margin-top: 1rem;">
      <ol style="padding-left: 1.5rem; margin-bottom: 1.5rem;">
        <li style="margin-bottom: 0.75rem;">El cliente se compromete a realizar los pagos quincenales según el cronograma establecido.</li>
        <li style="margin-bottom: 0.75rem;">En caso de mora, se aplicará un recargo del 5% sobre el monto de la cuota atrasada.</li>
        <li style="margin-bottom: 0.75rem;">MOVICUOTAS se reserva el derecho de bloquear el dispositivo mediante MDM en caso de mora mayor a 30 días.</li>
        <li style="margin-bottom: 0.75rem;">El cliente autoriza a MOVICUOTAS a verificar su información crediticia y laboral.</li>
        <li style="margin-bottom: 0.75rem;">El dispositivo permanecerá bloqueado hasta que se regularice la deuda.</li>
        <li style="margin-bottom: 0.75rem;">Cualquier modificación a este contrato debe ser por escrito y firmada por ambas partes.</li>
        <li style="margin-bottom: 0.75rem;">El cliente reconoce haber recibido el dispositivo en buen estado y funcionamiento.</li>
        <li style="margin-bottom: 0.75rem;">Este contrato se rige por las leyes de la República de Honduras.</li>
      </ol>
    </div>
  </div>

  <!-- Signatures Area (for printed version) -->
  <div class="signatures-section" style="margin-top: 3rem; page-break-inside: avoid;">
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 3rem; padding-top: 2rem; border-top: 2px solid #125282;">
      <div style="text-align: center;">
        <div style="height: 100px; border-bottom: 1px solid #d1d5db; margin-bottom: 1rem;"></div>
        <p style="font-weight: bold; color: #125282; margin-bottom: 0.25rem;">
          <%= customer.full_name %>
        </p>
        <p style="font-size: 10pt; color: #6b7280;">
          CLIENTE
        </p>
        <p style="font-size: 10pt; color: #6b7280; margin-top: 0.5rem;">
          No. Identidad: <%= customer.identification_number %>
        </p>
      </div>

      <div style="text-align: center;">
        <div style="height: 100px; border-bottom: 1px solid #d1d5db; margin-bottom: 1rem;"></div>
        <p style="font-weight: bold; color: #125282; margin-bottom: 0.25rem;">
          MOVICUOTAS
        </p>
        <p style="font-size: 10pt; color: #6b7280;">
          REPRESENTANTE AUTORIZADO
        </p>
        <p style="font-size: 10pt; color: #6b7280; margin-top: 0.5rem;">
          Sucursal: <%= loan.branch_number %>
        </p>
      </div>
    </div>

    <div style="text-align: center; margin-top: 2rem; font-size: 10pt; color: #6b7280;">
      <p>
        Fecha de firma: ___________________________ &nbsp;&nbsp;&nbsp; Lugar: ___________________________
      </p>
    </div>
  </div>
</div>