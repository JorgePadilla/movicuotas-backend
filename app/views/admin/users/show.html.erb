<% content_for :title, "Detalles del Usuario - Admin - MOVICUOTAS" %>

<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <!-- Page header -->
  <div class="mb-8 flex items-center justify-between">
    <div>
      <h1 class="text-3xl font-bold text-[#125282]"><%= @user.full_name %></h1>
      <p class="text-gray-600 mt-2"><%= @user.email %></p>
    </div>
    <div class="space-x-3">
      <%= link_to "Editar", edit_admin_user_path(@user), class: "bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-medium transition-colors" %>
      <% if @user != current_user %>
        <%= link_to "Eliminar", admin_user_path(@user), method: :delete, data: { confirm: "¿Estás seguro? Esta acción no se puede deshacer." }, class: "bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium transition-colors" %>
      <% end %>
    </div>
  </div>

  <!-- User details -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
    <!-- Personal Info -->
    <div class="bg-white rounded-xl shadow-md border border-gray-200 p-6">
      <h2 class="text-xl font-semibold text-[#125282] mb-6">Información Personal</h2>
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-600">Nombre Completo</label>
          <p class="text-lg text-gray-900 mt-1"><%= @user.full_name %></p>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-600">Email</label>
          <p class="text-lg text-gray-900 mt-1"><%= @user.email %></p>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-600">Sucursal</label>
          <p class="text-lg text-gray-900 mt-1"><%= @user.branch_number || "No asignada" %></p>
        </div>
      </div>
    </div>

    <!-- Role & Status -->
    <div class="bg-white rounded-xl shadow-md border border-gray-200 p-6">
      <h2 class="text-xl font-semibold text-[#125282] mb-6">Función y Estado</h2>
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-600">Función</label>
          <div class="mt-1">
            <span class="px-4 py-2 text-lg rounded-lg font-medium <%= @user.role == 'admin' ? 'bg-purple-100 text-purple-800' : @user.role == 'supervisor' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800' %>">
              <%= role_es(@user.role) %>
            </span>
          </div>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-600">Creado</label>
          <p class="text-lg text-gray-900 mt-1"><%= @user.created_at.strftime("%d de %B de %Y a las %H:%M") %></p>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-600">Última Actualización</label>
          <p class="text-lg text-gray-900 mt-1"><%= @user.updated_at.strftime("%d de %B de %Y a las %H:%M") %></p>
        </div>
      </div>
    </div>
  </div>

  <!-- Permissions based on role -->
  <div class="bg-white rounded-xl shadow-md border border-gray-200 p-6 mb-8">
    <h2 class="text-xl font-semibold text-[#125282] mb-6">Permisos</h2>
    <div class="space-y-2">
      <% if @user.admin? %>
        <p class="text-gray-700">✓ Acceso a todas las funciones administrativas</p>
        <p class="text-gray-700">✓ Gestión de usuarios y roles</p>
        <p class="text-gray-700">✓ Acceso al panel de control del sistema</p>
        <p class="text-gray-700">✓ Generación de reportes</p>
        <p class="text-gray-700">✓ Acceso a todas las sucursales</p>
      <% elsif @user.supervisor? %>
        <p class="text-gray-700">✓ Visualización de cuentas en mora</p>
        <p class="text-gray-700">✓ Bloqueo de dispositivos MDM</p>
        <p class="text-gray-700">✓ Verificación y rechazo de pagos</p>
        <p class="text-gray-700">✓ Historial de pagos (solo lectura)</p>
        <p class="text-gray-700">✓ Acceso a todas las sucursales</p>
        <p class="text-gray-700">✗ No puede crear o eliminar datos</p>
      <% elsif @user.vendedor? %>
        <p class="text-gray-700">✓ Proceso de venta (18 pantallas)</p>
        <p class="text-gray-700">✓ Búsqueda y registro de clientes</p>
        <p class="text-gray-700">✓ Creación de aplicaciones de crédito</p>
        <p class="text-gray-700">✓ Seguimiento de préstamos propios</p>
        <p class="text-gray-700">✗ Limitado a su sucursal asignada</p>
        <p class="text-gray-700">✗ No puede verificar pagos ni bloquear dispositivos</p>
      <% end %>
    </div>
  </div>

  <!-- Footer navigation -->
  <div class="flex justify-between items-center">
    <div>
      <%= link_to "← Volver a Usuarios", admin_users_path, class: "text-[#125282] hover:underline font-medium" %>
    </div>
    <div>
      <%= link_to "← Volver al Dashboard", admin_dashboard_path, class: "text-[#125282] hover:underline font-medium" %>
    </div>
  </div>
</div>
