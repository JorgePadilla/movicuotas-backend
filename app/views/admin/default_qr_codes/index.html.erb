<% content_for :title, "Administrar QR por Defecto - Admin" %>

<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
  <%# Header with Back Button %>
  <div class="mb-8">
    <%= link_to "‚Üê Volver al Dashboard", admin_dashboard_path, class: "text-[#125282] hover:text-[#0f4670] font-medium mb-4 inline-block" %>
    <h1 class="text-4xl font-bold text-gray-900">Administrar C√≥digo QR</h1>
    <p class="mt-2 text-gray-600">Este c√≥digo QR se mostrar√° a todos los clientes para configurar sus dispositivos</p>
  </div>

  <%# QR Code Section %>
  <div class="bg-white shadow-lg rounded-lg p-8">
    <h2 class="text-2xl font-bold text-gray-900 mb-6">C√≥digo QR para Configuraci√≥n del Dispositivo</h2>

    <div class="border-2 border-dashed border-gray-300 rounded-lg p-8">
      <% if @default_qr_code.qr_code_present? %>
        <div class="flex flex-col items-center">
          <%# Display QR Code Image %>
          <div class="mb-6 p-6 bg-gray-50 rounded-lg">
            <img src="<%= rails_blob_path(@default_qr_code.qr_code, disposition: 'inline') %>"
                 alt="Default QR Code"
                 class="w-64 h-64 border-4 border-[#125282]">
          </div>

          <div class="text-center mb-6">
            <p class="text-sm text-gray-600 mb-2">
              <strong>Cargado:</strong> <%= l(@default_qr_code.qr_code_uploaded_at, format: :long) if @default_qr_code.qr_code_uploaded_at %>
            </p>
            <p class="text-sm text-gray-600 mb-4">
              <strong>Cargado por:</strong> <%= @default_qr_code.qr_code_uploaded_by&.full_name %>
            </p>
          </div>

          <div class="flex gap-4">
            <%= link_to "Descargar", download_admin_default_qr_code_path(@default_qr_code),
                        class: "px-6 py-3 bg-[#125282] text-white rounded-lg hover:bg-[#0f4670] transition-colors font-medium",
                        download: true %>
            <%= link_to "Reemplazar", edit_admin_default_qr_code_path(@default_qr_code),
                        class: "px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors font-medium" %>
          </div>

          <%# Info Badge %>
          <div class="mt-8 w-full">
            <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded">
              <h3 class="text-sm font-bold text-blue-900 mb-2">üìå Este c√≥digo QR se muestra:</h3>
              <ul class="text-sm text-blue-800 space-y-1">
                <li>‚úì A todos los clientes en la p√°gina de √©xito del contrato</li>
                <li>‚úì Los clientes escanean este c√≥digo para configurar sus dispositivos</li>
                <li>‚úì Puedes actualizarlo en cualquier momento</li>
              </ul>
            </div>
          </div>
        </div>
      <% else %>
        <div class="text-center">
          <svg class="w-24 h-24 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
          </svg>
          <p class="text-lg text-gray-600 mb-6">No hay c√≥digo QR por defecto cargado a√∫n</p>
          <p class="text-sm text-gray-500 mb-6">Sube un c√≥digo QR que se mostrar√° a todos los clientes</p>
          <%= link_to "Cargar C√≥digo QR", edit_admin_default_qr_code_path(@default_qr_code),
                      class: "px-6 py-3 bg-[#125282] text-white rounded-lg hover:bg-[#0f4670] transition-colors font-medium" %>
        </div>
      <% end %>
    </div>
  </div>

  <%# Help Section %>
  <div class="mt-8 bg-yellow-50 border-l-4 border-yellow-400 p-6">
    <h3 class="text-sm font-bold text-yellow-900 mb-3">üí° ¬øC√≥mo funciona?</h3>
    <ol class="text-sm text-yellow-800 space-y-2 list-decimal list-inside">
      <li>Sube el c√≥digo QR de configuraci√≥n MDM</li>
      <li>Este QR aparecer√° en la p√°gina de √©xito de cada contrato</li>
      <li>Los clientes escanean el c√≥digo para configurar sus dispositivos</li>
      <li>Puedes actualizar el QR en cualquier momento si es necesario</li>
    </ol>
  </div>
</div>
