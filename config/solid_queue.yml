# Solid Queue Configuration
# https://github.com/rails/solid_queue

default: &default
  processes:
    - host: localhost
      queues: [ default, mailers, notifications, reminders, blocking ]
      concurrency: 5
      polling_interval: 0.1

development:
  <<: *default
  processes:
    - host: localhost
      queues: [ default, mailers, notifications, reminders, blocking ]
      concurrency: 5
      polling_interval: 1

test:
  <<: *default
  mode: inline

production:
  <<: *default
  # Optimized for $10 Lightsail (1 vCPU, 1GB RAM)
  # - Single process: less memory overhead
  # - 3 workers: enough for low traffic
  # - 1s polling: ~1 DB query/sec instead of ~30
  processes:
    - host: localhost
      queues: [ default, mailers, notifications, reminders, blocking ]
      concurrency: 3
      polling_interval: 1
