# Solid Queue Configuration
# https://github.com/rails/solid_queue

default: &default
  processes:
    - host: localhost
      queues: [ default, mailers, notifications, reminders, blocking ]
      concurrency: 5
      polling_interval: 0.1

development:
  <<: *default
  processes:
    - host: localhost
      queues: [ default, mailers, notifications, reminders, blocking ]
      concurrency: 5
      polling_interval: 1

test:
  <<: *default
  mode: inline

production:
  # ULTRA-OPTIMIZED for $10 Lightsail (1 vCPU, 1GB RAM)
  # - 2 threads: minimal memory footprint
  # - 5s polling: reduces DB queries to ~12/minute
  # - All queues in single worker
  dispatchers:
    - polling_interval: 5
      batch_size: 100
  workers:
    - queues: "*"
      threads: 2
      polling_interval: 5
